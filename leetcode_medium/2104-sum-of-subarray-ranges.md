## 2104. 子数组范围和

2022-03-04 09:18:09

### 题目

给你一个整数数组 ``nums`` 。``nums`` 中，子数组的 **范围** 是子数组中最大元素和最小元素的差值。

返回 ``nums`` 中 **所有** 子数组范围的 **和***。</em>

子数组是数组中一个连续 **非空** 的元素序列。



**示例 1：**

```
输入：nums = [1,2,3]
输出：4
解释：nums 的 6 个子数组如下所示：
[1]，范围 = 最大 - 最小 = 1 - 1 = 0
[2]，范围 = 2 - 2 = 0
[3]，范围 = 3 - 3 = 0
[1,2]，范围 = 2 - 1 = 1
[2,3]，范围 = 3 - 2 = 1
[1,2,3]，范围 = 3 - 1 = 2
所有范围的和是 0 + 0 + 0 + 1 + 1 + 2 = 4
```

**示例 2：**

```
输入：nums = [1,3,3]
输出：4
解释：nums 的 6 个子数组如下所示：
[1]，范围 = 最大 - 最小 = 1 - 1 = 0
[3]，范围 = 3 - 3 = 0
[3]，范围 = 3 - 3 = 0
[1,3]，范围 = 3 - 1 = 2
[3,3]，范围 = 3 - 3 = 0
[1,3,3]，范围 = 3 - 1 = 2
所有范围的和是 0 + 0 + 0 + 2 + 0 + 2 = 4
```

**示例 3：**

```
输入：nums = [4,-2,-3,4,1]
输出：59
解释：nums 中所有子数组范围的和是 59
```



**提示：**


- ``1 <= nums.length <= 1000``
- ``-10<sup>9</sup> <= nums[i] <= 10<sup>9</sup>``




**进阶：** 你可以设计一种时间复杂度为 ``O(n)`` 的解决方案吗？


[LeetCode链接](https://leetcode-cn.com/problems/sum-of-subarray-ranges/)

### 思路及代码

枚举连续子数组的左右边界，并根据上一次枚举数组的最大值和最小值更新当前的最值，计算并累加到当前到结果。

```cpp
class Solution {
public:
    long long subArrayRanges(vector<int>& nums) {
        long long res = 0;
        for(int i = 0; i < nums.size(); i++){
            int cur_min = nums[i];
            int cur_max = nums[i];
            for(int j = i + 1; j < nums.size(); j++){
                cur_min = min(cur_min, nums[j]);
                cur_max = max(cur_max, nums[j]);

                res += (cur_max - cur_min);
            }
        }
        return res;
    }
};
```


题目还可以使用单调栈进行求解，目标数值等价于所有区间最大值的和减去所有区间最小值的和。使用单调栈保存递增数列和递减数列，进一步计算出每个最大值/最小值有效的区间，累加到结果上。